<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <style>
      .modal-header,
      h4,
      .close {
        background-color: #f2d412;
        color: white !important;
        text-align: center;
        font-size: 30px;
      }
      .modal-footer {
        background-color: #f9f9f9;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header" style="padding: 35px 50px">
              <button type="button" class="close" data-dismiss="modal">
                &times;
              </button>
              <h4><span class="glyphicon glyphicon-lock"></span> Login</h4>
            </div>
            <div class="modal-body" style="padding: 40px 50px">
              <form role="form" id="loginForm">
                <div class="form-group">
                  <label for="email"
                    ><span class="glyphicon glyphicon-user"></span> Email</label
                  >
                  <input
                    type="text"
                    class="form-control"
                    id="email"      
                    placeholder="Enter email"
                  />
                </div>
                <!-- <div class="form-group">
                  <label for="password"
                    ><span class="glyphicon glyphicon-eye-open"></span>
                    Password</label
                  >
                  <input
                    type="password"
                    class="form-control"
                    id="password"
                    placeholder="Enter password"
                  /> -->
                </div>
                <div class="checkbox">
                  <!-- <label
                    ><input type="checkbox" value="" checked />Remember
                    me</label > -->
                </div>
                <button type="submit" class="btn bg-gradient-warning btn-block">
                  <span class="glyphicon glyphicon-off"></span> Enviar
                </button>
              </form>
            </div>
            <!-- <div class="modal-footer">
              <button
                type="button"
                class="btn btn-danger btn-default pull-left"
                data-dismiss="modal"
              >
                <span class="glyphicon glyphicon-remove"></span> Cancel
              </button> -->
              <!-- <p>Not a member? <a href="#">Enviar</a></p> -->
             
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      
      $(document).ready(function () {
        // Mostrar o modal automaticamente ao carregar a página
        $("#myModal").modal();

        $("#loginForm").submit(function (event) {
          event.preventDefault();
          var email = $("#email").val();
         

          // if (email === "adm@gmail.com" && password === "123456") {
          //   // Redireciona para outra página
          //   window.location.href = " ";
          // } else {
          //   alert("Email inexistente !");
          // }
        });
      });
      localStorage.setItem('registeredEmails', JSON.stringify(['user1@example.com', 'user2@example.com']));

    document.getElementById('reset-email-form').addEventListener('submit', function (e) {
      e.preventDefault();
      const email = document.getElementById('email').value;
      const registeredEmails = JSON.parse(localStorage.getItem('registeredEmails')) || [];

      if (registeredEmails.includes(email)) {
        fetch('/send-reset-email', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ email })
        })
        .then(response => response.text())
        .then(data => alert(data))
        .catch(error => console.error('Erro:', error));
      } else {
        alert('Email não registrado');
      }
    });

    document.getElementById('reset-password-form').addEventListener('submit', function (e) {
      e.preventDefault();
      const newPassword = document.getElementById('new-password').value;
      const token = document.getElementById('reset-token').value;

      fetch('/reset-password', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ token, newPassword })
      })
      .then(response => response.text())
      .then(data => alert(data))
      .catch(error => console.error('Erro:', error));
    });

    // Função para obter o token da URL
    function getTokenFromUrl() {
      const params = new URLSearchParams(window.location.search);
      return params.get('token');
    }

    // Se houver um token na URL, preencher o campo hidden
    const token = getTokenFromUrl();
    if (token) {
      document.getElementById('reset-token').value = token;
    }
    </script>
  </body>
</html>
